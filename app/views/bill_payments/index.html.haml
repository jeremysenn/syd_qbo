= render partial: "shared/navbars/bill_payments_navbar", locals: {title: "Paid"}
- @title="Paid" 

.container
  -#
    %p
      .btn-group
        = link_to "Open", purchase_orders_path, :class => "btn btn-default btn-lg", id: 'payments_to_open', data: {disable_with: "<i class='fa fa-spinner fa-spin'></i> Open"}
        = link_to "Closed", bills_path, :class => "btn btn-default btn-lg", id: 'payments_to_closed', data: {disable_with: "<i class='fa fa-spinner fa-spin'></i> Closed"}
        %button{class: 'btn btn-default btn-lg active'}
          Paid
        = link_to "Vendors", vendors_path, :class => "btn btn-default btn-lg", id: 'payments_to_vendors', data: {disable_with: "<i class='fa fa-spinner fa-spin'></i> Vendors"}
  - if @bill_payments.blank?
    .jumbotron
      %p.text-center No payments found
  - else
    -#
      %div.row
        .col-xs-12.col-sm-12.col-md-12
          %div.panel{style: 'border: 0;'}
            %div.panel-body
              -#
                %div.col-xs-3.col-sm-3.col-md-3
                  %strong Photo
              %div.col-xs-4.col-sm-4.col-md-4.col-lg-4
                %strong Ticket
              %div.col-xs-4.col-sm-4.col-md-4.col-lg-4
                %strong Vendor
              %div.col-xs-4.col-sm-4.col-md-4.col-lg-4
                %strong Amount
    %div{id: 'bill_payments'}
      - @bill_payments.sort_by(&:txn_date).reverse.each do |bill_payment|
        %div.row
          .col-xs-12.col-sm-12.col-md-12
            %div.panel.panel-primary
              -#
                %div.panel-body{style: "padding: 0;"}
                  %div.col-xs-3.col-sm-3.col-md-3.col-lg-3{style: "padding: 0;"}
                    %a{href: bill_payment_path(bill_payment.id), class: "", data: {disable_with: "<i class='fa fa-spinner fa-spin fa-5x'></i>"}}
                      - if Image.where(ticket_nbr: bill_payment.doc_number, event_code: "Gross").count > 0
                        = image_tag(show_preview_image_image_path(Image.where(ticket_nbr: bill_payment.doc_number, event_code: "Gross").last.id), class: 'img-responsive')
                      - else
                        %span.fa-stack.fa-3x
                          %i.fa.fa-ban.fa-stack-2x
                          %i.fa.fa-camera.fa-stack-1x
                        =# image_tag("no_photo320x240.jpeg", class: 'img-responsive')
              -#
                %div.panel-body
                  %div.col-xs-4.col-sm-4.col-md-4.col-lg-4
                    %a{href: bill_payment_path(bill_payment.id), class: "bill_payment_button", data: {disable_with: "<i class='fa fa-spinner fa-spin fa-lg'></i> #{bill_payment.doc_number}"}}
                      = bill_payment.doc_number
                      %br
                      %small= bill_payment.txn_date.strftime("%m/%d/%y")
                  %div.col-xs-4.col-sm-4.col-md-4.col-lg-4= bill_payment.vendor_ref.name unless bill_payment.vendor_ref.blank?
                  %div.col-xs-4.col-sm-4.col-md-4.col-lg-4= number_to_currency(bill_payment.total)
                  .pull-right
                    %a{href: bill_payment_path(bill_payment.id, format: 'pdf'), target: '_blank'}
                      %i.fa.fa-file-pdf-o.fa-lg
                    &nbsp;
              %div.list_group
                %a{href: bill_payment_path(bill_payment.id), class: "list-group-item bill_payment_button", data: {disable_with: "<i class='fa fa-spinner fa-spin fa-lg'></i> #{bill_payment.doc_number} #{bill_payment.vendor_ref.name}"}}
                  = bill_payment.doc_number
                  = bill_payment.vendor_ref.name unless bill_payment.vendor_ref.blank?
                  .pull-right
                    = number_to_currency(bill_payment.total)
                    %i.fa.fa-chevron-right
                %a{href: bill_payment_path(bill_payment.id, format: 'pdf'), class: "list-group-item", target: '_blank'}
                  = bill_payment.txn_date.strftime("%m/%d/%y")
                  .pull-right
                    %i.fa.fa-file-pdf-o.fa-lg
                    Print
    %div.row
      .text-center
        %div{id: 'endless_page'}
          %p= image_tag("ajax-loader.gif", :id => "spinner", :alt => "Loading ...", style: "display:none;")
          %p= link_to 'Load more ...', bill_payments_path(:page => @bill_payments.next_page), :class => 'load-more-bill-payments btn btn-default', :remote => true, :onclick => "$(this).hide(); $('#spinner').show();" if @bill_payments.next_page


= render partial: "shared/bill_payments_footer_navbar", locals: {title: "BillPayment"}
